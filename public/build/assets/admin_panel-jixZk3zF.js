var V=Object.defineProperty;var k=s=>{throw TypeError(s)};var z=(s,a,t)=>a in s?V(s,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[a]=t;var f=(s,a,t)=>z(s,typeof a!="symbol"?a+"":a,t),I=(s,a,t)=>a.has(s)||k("Cannot "+t);var l=(s,a,t)=>(I(s,a,"read from private field"),t?t.call(s):a.get(s)),h=(s,a,t)=>a.has(s)?k("Cannot add the same private member more than once"):a instanceof WeakSet?a.add(s):a.set(s,t),P=(s,a,t,e)=>(I(s,a,"write to private field"),e?e.call(s,t):a.set(s,t),t),d=(s,a,t)=>(I(s,a,"access private method"),t);import{U as K,C as i}from"./Core-DAdlDyCj.js";import{E as Q,P as W}from"./PageManager-DG16GQE0.js";var y,b,L,E,g,w,T,r,C,O,R,x,U,N,H,F;class D extends K{constructor(t){super();h(this,r);h(this,y,i.get_main_container_id());h(this,b,i.get_domain());h(this,L,{});h(this,E,{});h(this,g,null);h(this,w,[]);h(this,T,null);f(this,"ELM",null);if(!v.getInstance())throw Error("Admin Panel is not instantiated");if(!t.name)throw Error("Missing Parameter : config.name : string");this.ELM=new Q,P(this,L,t),P(this,g,t.name),d(this,r,C).call(this)}get data(){return l(this,E)}set data(t){return P(this,E,t)}init(){}boot(){}async render(){const t=document.getElementById(l(this,y));t.innerHTML="",t.innerHTML=await d(this,r,U).call(this),this.data=null,d(this,r,R).call(this),this.eventDispatch(`${l(this,g)}_launch`)}_destroy(){i.debugLog("panel cleaned"),this.clean()}clean(){}getName(){return l(this,g)}addListner(t,e){i.EM.subscribe(t,e)}eventDispatch(t){i.EM.emit(t)}async requestActionProcess(t,e,n={}){if(!e||!t)throw new Error("Invalid Action Process");const o=t==="view"||t==="get"?"GET":"POST";if(t!=="view"&&t!=="get"){const p=i.APIR.createFormData(this.scrapeData(e));e.querySelectorAll("[data-image-picker]").forEach(M=>{let S=1;i.ImageInputManager.getPicker(M).picker.getImageFiles().forEach(J=>{let q=M.dataset.name+"_"+S;console.log(q),p.append(q,J),S++}),console.log(i.ImageInputManager.getPicker(M).picker.getImageFiles())}),n={body:p,...n},console.log("options is modified"+t)}const u=[()=>this.clearInputs(e)],_=[];return e.dataset.onsuccess&&e.dataset.onsuccess.split(" ").forEach(p=>{u.push(this[p]?this[p]:()=>{})}),e.dataset.onfailed&&e.dataset.onfailed.split(" ").forEach(p=>{_.push(this[p]?this[p]:()=>{})}),console.log(n),await i.APIR.request(o,e.dataset.endpoint??"/",n,{success:u,failed:_})}scrapeData(t){const e=t.querySelectorAll("input[name], textarea[name], select[name], [data-custom-data]"),n={};return e.forEach(o=>{n[o.name]=o.value??""}),n}async viewProcessEventAction(t){const e=await this.requestActionProcess("view",t);switch(t.dataset.viewType){case"table":const n=t.dataset.field.split(" ");e.forEach(o=>{t.innerHTML+=o[n[1]]+" : "+o[n[0]]+"<br>"});break;case"list":console.log(e);break}console.log("proform viewing operations : "+t.dataset.adminContainer)}async addProcessEventAction(t){const e=await this.requestActionProcess("add",t);e!==!1&&i.toast.show("info",e),console.log("proform adding operations : "+t.dataset.adminContainer)}async updateProcessEventAction(t){const e=await this.requestActionProcess(t,{method:"POST"});i.toast.show("info",e),console.log("proform updating operations : "+t.dataset.adminContainer)}}y=new WeakMap,b=new WeakMap,L=new WeakMap,E=new WeakMap,g=new WeakMap,w=new WeakMap,T=new WeakMap,r=new WeakSet,C=function(){this.addListner(`${l(this,g)}_switch`,()=>{v.switchPanel(l(this,g))}),d(this,r,O).call(this),this.init()},O=function(){},R=function(){d(this,r,N).call(this),d(this,r,x).call(this),this.boot()},x=function(){},U=async function(){return i.EM.emit("panel_fetch_start"),await fetch(`${l(this,b)}/comp/panel/${l(this,g)}`).then(t=>t.text()).then(t=>(i.EM.emit("panel_fetch_end"),t)).catch(t=>{i.EM.emit("panel_fetch_error",t),i.EM.emit("panel_fetch_end"),i.toast.show("error","Panel template loading failed!😵"),console.error(t),console.error("Panel template loading failed! : UI fetch failed")})},N=function(){d(this,r,F).call(this);const t=document.querySelectorAll("[data-admin-container]");let e="",n=null;t.forEach(o=>{if(o.dataset.isView){this.viewProcessEventAction(o);return}else n=o.querySelector("[data-btn-action]"),e=n?n.dataset.btnAction:"";d(this,r,H).call(this,o);const u=()=>{switch(e){case"add":this.addProcessEventAction(o);break;case"update":this.updateProcessEventAction(o);break}};n&&(n.addEventListener("click",u),l(this,w).push({event:"click",btn:n,action:u}))})},H=function(t){t.querySelectorAll("select[data-options]").forEach(e=>{i.AO.stopObserving(e,"data-options");function n(){e.innerHTML="";try{JSON.parse(e.dataset.options).forEach(o=>{const u=document.createElement("option");u.value=o[0],u.text=o[1],e.appendChild(u)})}catch{throw new Error("Invalid Selector Configuration at :"+t.dataset.adminContainer)}}n(),i.AO.observeAttribute(e,"data-options",n)})},F=function(){l(this,w).forEach(t=>{t.btn.removeEventListener(t.event,t.action)}),P(this,w,[]),console.log("cleaned")};class X extends D{constructor(a){super(a)}init(){}async boot(){this.test()}test(){}}class Y extends D{constructor(a){super(a)}init(){}async boot(){this.test()}test(){}}var A,m,$,j,B;const c=class c extends i{constructor(){super();h(this,m);f(this,"info",null);f(this,"UI",null);f(this,"activePanel",null);f(this,"data",{application_name:"Laravania Admin Dashboard",application_version:"1.0.0",application_copyright:"Made with ❤️ by Algowrite © 2024. All Rights Reserved By Algowrite Solutions"});P(c,A,this),d(this,m,$).call(this)}static get instance(){return l(c,A)??null}async test(){console.log("test ===> start"),console.log(this.info.started_time)}static getInstance(){return c.instance??null}static getPanelList(){return c.getInstance().UI.panels}static getPanel(t){return c.getPanelList().forEach(e=>{if(e.name===t)return e}),null}static getCurrentPanel(){return c.getInstance().activePanel??null}static async switchPanel(t){const e=c.getInstance();c.getPanelList().forEach(async n=>{n.getName()===t&&(c.getPanelList().forEach(o=>{o._destroy()}),await n.render(),e.info.activePanelName=t,e.activePanel=c.getPanel(t))})}};A=new WeakMap,m=new WeakSet,$=async function(){this.info={started_time:new Date,state:"live",activePanelName:"test"},this.activePanel=null,this.UI={panels:d(this,m,B).call(this)},await d(this,m,j).call(this)},j=async function(){document.querySelectorAll("[data-admin-panel-switch]").forEach(t=>{t.addEventListener("click",()=>{c.switchPanel(t.dataset.adminPanelSwitch)})}),c.switchPanel(this.info.activePanelName)},B=function(){return[new Y({name:"dashboard"}),new X({name:"test"})]},h(c,A,null);let v=c;class G extends W{constructor(){super("admin-dashboard")}async load(){this.data={title:"Admin Dashboard",description:"Admin Dashboard Page"}}init(){this.getAdmin()}setListners(){}actions(){}async getAdmin(){const a=await i.RM.get("/admin/session",{},{requestType:"json",responseType:"json"});i.UIM.setFields("adminProfile",a)}static async logout(){await i.RM.post("/admin/logout",{},{requestType:"json",responseType:"json",onSuccess:()=>{window.location.href="/admin"}})}}document.addEventListener("DOMContentLoaded",()=>{console.log("admin panel loaded"),new v,new G("admin-dashboard")});const Z=()=>{G.logout()};window.adminLogOut=Z;
